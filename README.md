# Система генерации промптов для изображений

## Описание
Программа генерирует художественный текст по заданной **теме**, а затем формирует список промптов, соответствующих указанному **стилю**.   
Результаты сохраняются в файл **`output.txt`**.

## Аргументы командной строки
`--theme` - тема текста. По умолчанию `Космос`.  
`--style` - стиль текста. По умолчанию `Киберпанк`.  
`--number` - необходимое количество промтов. По умолчанию `1`.

Сгенерированый промт может быть некорректным.  
Некорректные промпты программа не выводит, а пытается создать еще раз.  
Чтобы генерация промтов не была бесконечна, есть ограничение.  
Пользователь может сам ограничить количество генераций с помощью опции `--max_num`. По умолчанию `2`.

### Этапы работы
1. Генерация текста по теме (`--theme`).
2. Генерация списка слов, характерных для выбранного стиля (`--style`).
3. Цикличная генерация и отбор текстов, содержащих слова этого стиля.
4. Сохранение итоговых текстов в файл.

## Конфигурация
Пользователь может задать параметры генерации внутри файла `config.json`.  
Например:
```json
{
    "model": "Qwen/Qwen2.5-1.5B-Instruct",
    "max_new_tokens": 100,
    "do_sample": true,     
    "temperature": 0.8,          
    "top_p": 0.9,
    "top_k": 10,
    "repetition_penalty": 1.15
}
```

### Модель
Модель обязательно должна поддерживать генерацию текста.   
С моделью не предназначенной для этого программа работать **не будет**.

## Установка
`pip install torch transformers accelerate`

## Пример запуска
`python main.py --theme "Космос" --style "Киберпанк" --number 2 --max_num 4`
